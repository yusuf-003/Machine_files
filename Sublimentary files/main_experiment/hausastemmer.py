#!/usr/bin/env python
# coding: utf-8

# In[5]:


class HausaStemmer:
    def __init__(self):
        # Define a list of stopwords
        self.stopwords = ['a', 'amma', 'ba', 'ban', 'ce', 'cikin', 'da', 'don', 'ga', 'in', 'ina', 'ita', 'ji', 'ka', 'ko', 'kuma', 'lokacin', 'ma', 'mai', 'na', 'ne', 'ni', 'sai', 'shi', 'su', 'suka', 'sun', 'ta', 'tafi', 'take', 'tana', 'wani', 'wannan', 'wata', 'ya', 'yake', 'yana', 'yi', 'za']
        
        # Define a dictionary of common words (you can expand this)
        self.dictionary = {
            'murhu': 'murh',
            'murahu': 'murh',
            'karya':'karya',
            'karnuka':'kare',
            'karnukan':'kare',
            'sarki':'sark',
            'sarakai':'sark',
            'manazarci':'nazarci',
            'masunci':'sunci',
            'masunciya':'sunci',
            'bakano':'kano',
            'bakaniya':'kano',
            'baduddire':'guddire',
            'gidaje':'gida',
            'bishiya':'bishiya',
            'bishiyoyi':'bishiya',
            'falake':'falke',
            'rumfuna':'runfa',
            'benenaye':'bene',
            'rafuna':'rafi',
            'dakuna':'daki',
            'Dalibai':'dalib',
            'dalibi':'dalib',
            'daliba':'dalib',
            'yara':'yaro',
            'yarinya':'yaro',
            'mabuɗi': 'buɗi',
            'mayanka':'yanka',
            'mawaƙi':'waƙa',
            'banufiya':'nufe',
            'bakatsine':'bakatsine',
            'gurgu':'gurgu',
            'guragu':'guragu',
            'gurguwa':'guragu',
            'kurame':'kurma',
            'birane':'birni',
            'barade':'barde',
            'dokuna':'doki',
            'rubutu':'rubutu',
            'rubuta':'rubutu',
            'rubutai':'rubutu',
            'rubututtuka':'rubutu',
            'tsuntsuwa':'tsuntsu',
            'tsuntsaye':'tsuntsu',
            'alamar':'alama',
            'alamomin':'alama',
            'alamu':'alama',
            'alamun':'alama',
            'asibitin':'asibiti',
            'musulmai':'musulmi',
            'musulmi':'musulmi',
            'musulma':'musulmi',
            'sa"o"i' :'sa"a"',
            'shugabannin':'shugaba',
            'wayoyin':'waya',
            'kare':'kare',
            'kazanta':'kazanta',
            'kazama':'kazanta',
            'kunnai':'kunne',
            'mummunan':'mummuma',
            'sabuwar':'sabo',
            'sabon':'sabo',
            'sababbi':'sabo',
            'sabofil':'sabo',
            'sabuwa':'sabo',
            'kashi':'kashi',
            'guje-guje':'guje',
            'guduwa':'gudu',
            'madafai':'madafa',
            'marubuta':'rubutu',
            'marubuciya':'rubutu',
            'mahaukaci':'hauka',
            'mahaukaciya':'hauka',
            'rubuce-rubuce':'rubutu',
            'abokai':'aboki',
            'abokina':'aboki',
            'abokinsa':'aboki',
            'abokanansa':'aboki',
            'abokina':'aboki',
            'littattafai':'litafi',
            'bangarori':'bangare',
            'bangaren':'bagare',
            'gidaje':'gida',
            'gidajen':'gida',
            'gidajensu':'gida',
            'gidan':'gida',
            'gidanka':'gida',
            'gidansa':'gida',
            'gidansu':'gida',
            'ramuka':'rami',
            'mazaje':'maza',
            'yanmata':'mata',
            'huluna':'hula',
            'makarantu':'makaranta',
            'amincin':'aminci',
            'shugabanmu':'shugaba',
            'ahlayensa':'iyali',
            'Kyawawan':'Kyau',
            'ciki':'cikin',
            'duniyarsu':'duniya',
            'labarin':'labari',
            'kasashe':'kasa',
            'wautar':'wauta',
            'kasarku':'kasa',
            'sarkinsu':'sarki',
            'wazirinmu':'waziri',
            'labarinsan':'labari',
            'hakikance':'hakika',
            'wazirci':'waziri',
            'dubbai':'dubu',
            'mulkinmu':'mulki',
            'mulki':'mulki',
            'kadaici':'kadai',
            'kawaici':'kawai',
            'tagwataka':'tagwai',
            'bambanci':'bambam',
            'hallaci':'halak',
            'mutuntaka':'mutum',
            'jahilci':'jahili',
            'laifci':'laifi',
            'gajarta':'gajere',
            'samartaka':'samari',
            'boranci':'bora',
            'wawanci':'wauta',
            'gurgunta':'gurgu',
            'kumamanta':'kumama',
            'abokanta':'aboki',
            'abokantaka':'aboki',
            'bauta':'bawa',
            'maita':'maye',
            'gabaci':'gaba',
            'kusanci':'kusa',
            'lalaci':'lalata',
            'bakunci':'bako',
            'bokunta':'bako',
            'gabunta':'gabo',
            'sabuntaka':'sabo',
            'wofinta':'wofi',
            'gwaninta':'gwani',
            'dolonci':'dolo',
            'gwarzantaka':'gwarzo',
            'shegantaka':'shege',
            'gwamunta':'gwame',
            'fatauki':'fatauci',
            'fatake':'fatauci',
            'bajintaka':'bajimi',
            'mahukunta':'hukunci',
            'hukuma':'hukunci',
            'karanta':'karami',
            'malami':'malam',
            'malanta':'malam',
            'azzalumi':'zalinci',
            'zalimu':'zalinci',
            'munafiki':'munafucci',
            'sharifi':'sharifta',
            'amartaka':'amarya',
            'budurci':'budur',
            'budurwa':'budur',
            'annabta':'annabi',
            'samartaka':'samari',
            'yaranta':'yaro',
            'yara':'yaro',
            'talaka':'talauci',
            'matalauci':'talauci',
            'talakawa':'talauci',
            'makauninya':'makanta',
            'makaho':'makanta',
            'sirantaka':'siranta',
            'siriri':'siranta',
            'gwargwarci':'gwauro',
            'gwaurantaka':'gwauro',
            'benentaka':'bebe',
            'bebenci':'bebe',
            'danyantaka':'danye',
            'hakimtataka':'hakimta',
            'hakimi':'hakimta',
            'walitta':'walicci',
            'waliyi':'walicci',
            'waliya':'walicci',
            'bashi':'bash',
            'bauri':'baur',
            'daci':'dac',
            'danshi':'dansh',
            'dari':'dar',
            'fadi':'fad',
            'gautsi':'gautsi',
            'kaifi':'kaif',
            'kanshi':'kansh',
            'karni':'karn',
            'kunci':'kunc',
            'karfi':'karf',
            'kwari':'kwar',
            'lami':'lam',
            'laushi':'laush',
            'nauyi':'nauy',
            'santsi':'sants',
            'sanyi':'sany',
            'sauki':'sauk',
            'sauri':'saur',
            'tauri':'taur',
            'tsami':'tsam',
            'tsamiya':'tsam',
            'tsarki':'tsark',
            'wari':'war',
            'yauki':'yauk',
            'zafi':'zaf',
            'zaki':'zak',
            'zarni':'zarn',
            'zari':'zarn',
            'zartsi':'zarts',
            'zurfi':'zurf',
            'bazakiya':'zako',
            'daci':'dac',
            'doyi':'doy',
            'muni':'mun',
            'tsini':'tsin',
            'wukake':'wuka',
            'dumi':'dum',
            'daci':'daci',
            'daci-daci':'daci',
            'kauri-kauri':'kauri',
            'bashi-bashi':'bashi',
            'bauri-bauri':'bauri',
            'daci-daci':'daci',
            'danshi-danshi':'danshi',
            'daari-daari':'dari',
            'gautsi-gautsi':'gautsi',
            'kaifi-kaifi':'kaifi',
            'kanshi-kanshi':'kanshi',
            'karni-karni':'karni',
            'karfi-karfi':'karfi',
            'kwari-kwari':'kwari',
            'lami-lami':'lami',
            'laushi-laushi':'laushi',
            'nauyi-nauyi':'nauyi',
            'santsi-santsi':'santsi',
            'sanyi-sanyi':'sany',
            'sauki-sauki':'sauki',
            'sauri-sauri':'sauri',
            'tauri-tauri':'tauri',
            'tsami-tsami':'tsami',
            'wari-wari':'wari',
            'yauki-yauki':'yauki',
            'zafi-zafi':'zafi',
            'zaki-zaki':'zaki',
            'zarni-zarni':'zarni',
            'zari-zari':'zari',
            'zartsi-zartsi':'zartsi',
            'zurfi-zurfi':'zurfi',
            'daci-daci':'daci',
            'doyi-doyi':'doyi',
            'muni-muni':'muni',
            'tsini-tsini':'tsini',
            'dumi-dumi':'dumi',
            'dumi-duminsa':'dumi',
            'faffada':'fadi',
            'zazzaka':'zaki',
            'zuzzurfa':'zurfi',
            'fadada':'fadi',
            'zakaka':'zaki',
            'zurfafa':'zurfi',
            'zazzafa':'zafi',
            'karfaffa':'karfi',
            'gaggautsa':'gautsi',
            'gautsatsa':'gautsi',
            'rarrauna':'rauni',
            'raunana':'rauni',
            'sassantsa':'santsi',
            'santsatsa':'satsi',
            'zazzartsa':'zartsi',
            'kyakkawa':'kyau',
            'kyawawa':'kyau',
            'mummuna':'muni',
            'munana':'muni',
            'girmama':'girma',
            'sirara':'siriri',
            'kausasa':'kaushi',
            'saukaka':'sauki',
            'taurara':'tauri',
            'tsarkaka':'tsarki',
            'yausasa':'yaushi',
            'zakaka':'zaki',
            'sauwaka':'saki',
            'saukake':'saki',
            'dafaffe':'dahuwa',
            'dafe-dafe':'dahuwa',
            'cikakke':'cika',
            'cikakkiya':'cika',
            'cikakku':'cika',
            'dafaffiya':'dahuwa',
            'dafaffu':'dahuwa',
            'gagararre':'gagare',
            'gagararriya':'gagare',
            'gagararru':'gagare',
            'gasasshe':'gashi',
            'gasassu':'gashi',
            'gasasshiya':'gashi',
            'satacce':'sata',
            'satacciya':'sata',
            'sataccu':'sata',
            'tsukakke':'tsuku',
            'tsukuku':'tsuku',
            'tsukkiya':'tsuku',
            'tsukakku':'tsuku',
            'yagalgalle':'yagala',
            'yagalgalliya':'yagala',
            'yagalgalallu':'yagala',
            'matacce':'mutuwa',
            'mutacciya':'mutuwa',
            'matattu':'mutuwa',
            'gajiya':'gaji',
            'gajiyayye':'gaji',
            'gajiyayya':'gaji',
            'gajiyayyu':'gaji',
            'tafiya':'tafi',
            'matafiyi':'tafi',
            'matafiya':'tafi',
            'tafiyayye':'tafi',
            'tafiyayya':'tafi',
            'tafiyayya':'tafi',
            'ci':'ci',
            'ciyayye':'ci',
            'ciyayyu':'ci',
            'ciyayyiya':'ci',
            'ciyayyu':'ci',
            'lafiyayye':'lafiya',
            'lafiyayya':'lafiya',
            'lafiyayyu':'lafiya',
            'masifaffiya':'masifa',
            'masifaffe':'masifa',
            'masifaffu':'masifa',
            'wankakku':'wanki',
            'wankakke':'wanki',
            'wankakkiya':'wanki',
            'motoci':'mota',
            'kunsasshe':'kunsa',
            'kunsasshiya':'kunsa',
            'kunsasshu':'kunsa',
            'yagawa':'yagi',
            'yagaggiya':'yagi',
            'yagaggu':'yagi',
            'yagagge':'yagi',
            'tababbe':'tabi',
            'tababbiya':'tabi',
            'tabbabu':'tabi',
            'kwababbiya':'kwabi',
            'kwaba':'kwabi',
            'kwababbi':'kwabi',
            'kwababbu':'kwabi',
            'marowaci':'rowa',
            'marowancin':'rowa',
            'bahaguwa':'hagu',
            'bahago':'hagu',
            'balo-balo':'fito',
            'ruwa-ruwa':'ruwa',
            'ruku-ruku':'ruku',
            'buhu-buhu':'buhu',
            'gari-gari':'gari',
            'gudaji-gudaji':'gudaji',
            'hoto-hoto':'hoto',
            'shiru-shiru':'shiru',
            'tsakuwa-tsakuwa':'tsakuwa',
            'yashi-yashi':'yashi',
            'baki-baki':'baki',
            'fari-fari':'fari',
            'dogo-dogo':'dogo',
            'baka-baka':'baki',
            'doguwa-doguwa':'doguwa',
            'daffafe-daffafe':'daffafe',
            'kakkaura':'kauri',
            'jaja-jaja':'ja',
            'bagidajiya-bagidajiya':'bagidaji',
            'bagidaje-bagidaje':'bagidaji',
            'santala-santala':'santala',
            'sanu-sanu':'ahankali',
            'faufau':'fau',
            'yanmata':'mata',
            'koyaya':'koya',
            'bazar-bazar':'bazar',
            'cibiya':'cibi',
            'zuciya':'zuci',
            'hannaye':'hannu',
            'kunnuwa':'kunne',
            'asussuba':'asuba',
            'maza-maza':'maza',
            'marmaza':'maza',
            'mafadaci':'fada',
            'mafadaciya':'fada',
            'mafadata':'fada',
            'mahaifi':'haifa',
            'mahaifiya':'haifa',
            'mahaifa':'haifa',
            'maroki':'roko',
            'maroka':'roko',
            'marokiya':'roko',
            'matsoraci':'tsoro',
            'matsoraciya':'tsoro',
            'matsorata':'tsoro',
            'maboyi':'bi',
            'mabiya':'bi',
            'maniyyaci':'niyya',
            'maniyata':'niyya',
            'makadaici':'kadaita',
            'makadaita':'kadaita',
            'mahadddaci':'hadda',
            'mahaddaciya':'hadda',
            'mahaddata':'hadda',
            'masani':'sani',
            'masana':'sani',
            'masaniya':'sani',
            'dagula':'dagulau',
            'doke':'duka',
            'mare':'mari',
            'azabtar':'azaba',
            'amince':'amincewa',
            'sari':'sara',
            'wanke':'wanki',
            'wanke-wanke':'wanki',
            'tsoratarwa':'tsoro',
            'dauru':'dauri',
            'sukan':'suka',
            'zabi':'zabe',
            'badin-badada':'badada',
            'kumbura':'kunburi',
            'gabace':'gaba',
            'wulakantacce':'wulakanci',
            'wulakantaciya':'wulakanci',
            'bafaranshe':'faransa',
            'bafaranshiya':'faransa',
            'faransawa':'faransa',
            'bahaushe':'hausa',
            'bahaushiya':'hausa',
            'hausawa':'hausa',
            'bajamushe':'jamus',
            'bajamushiya':'jamus',
            'jamusawa':'jamus',
            'bamasine':'sin',
            'bamasiniya':'sin',
            'sinawa':'sin',
            'bakano':'kano',
            'bakatsine':'katsina',
            'bakatsiniya':'katsina',
            'katsinawa':'katsina',
            'balarabe':'larabci',
            'balarabiya':'larabci',
            'larabawa':'larabci',
            'bamisire':'misra',
            'bamisiriya':'misra',
            'misirawa':'mistra',
            'basakkwace':'sakwato',
            'basakkwata':'sakwato',
            'sakkwatawa':'sakwato',
            'bature':'turai',
            'baturiya':'turai',
            'turawa':'turai',
            'bayarabe':'yarbawa',
            'bayaraba':'yarbawa',
            'yarbawa':'yarbawa',
            'banufe':'nufe',
            'banufa':'nufe',
            'nufawa':'nufe',
            'bazamfare':'zanfara',
            'bazanfara':'zanfara',
            'zanfarawa':'zanfara',
            'bamalike':'malik',
            'malikawa':'malik',
            'bamalikkiya':'malik',
            'bazaurawa':'zawarci',
            'zaurawa':'zawarci',
            'zauranci':'zawarci',
            'badauri':'daura',
            'daurawa':'daura',
            'dadauriya':'daura',
            'bafillace':'fulo',
            'bafillaciya':'fulo',
            'bafilatana':'fulo',
            'fulani':'fulo',
            'gabasawa':'gabas',
            'gabashiya':'gabas',
            'gabasawa':'gabas',
            'bazzazagi':'zariya',
            'zazzagawa':'zariya',
            'bazazzagiya':'zariya',
            'bazazzaga':'zaria',
            'gobirawa':'gobir',
            'bagoburi':'gobir',
            'bagidaje':'gidadanci',
            'batijjane':'tijjani',
            'adamawa':'adamawa',
            'agadasawa':'agadas',
            'kasuwoyi':'kasuwa',
            'gyare-gyaren':'gyara',
            'dakwalwa':'dakwale',
            'cif-cif':'cif',
            'dar-dar':'dar',
            'kwal-kwal':'kwal',
            'hakalimmu':'hakali',
            'karyace-karyace':'karya',
            'adaranci':'adar',
            'yarbanci':'yarbawa',
            'hausanci':'hausa',
            'barbanci':'barebari',
            'duniyanci':'duniya',
            'fadanci':'fada',
            'filatanci':'fulo',
            'ganganci':'gangan',
            'kabilanci':'kabila',
            'malamanci':'malami',
            'kananci':'kano',
            'kudanci':'kudu',
            'yammaci':'yamma',
            'gabshi':'gabas',
            'arewanci':'arewa',
            'auratayya':'aure',
            'fasinjoji':'fasinja',
            'harzuwa':'zuwa',
            'kaffafuwa':'kafa',
            'mimmike':'mika',
            'kudin':'kudi',
            'babu':'babu',
            'abin':'abu',
            'agani':'gani',
            'kasa':'kasa',
            'kasuwanci':'kasuwa',
            'hanyoyi':'hanya',
            'komai':'komai',
            'cinhanci':'cinhanci',
            'rashawa':'rashawa',
            'Adu ar':'adu a',
            'haka':'haka',
            'kaci':'kaci',
            'muku':'muku',
            'yawa':'yawa',
            'yanzu':'yanzu',
            'kuna':'kuna',
            'talakan':'talaka',
            'bayan':'bayan',
            'wanda':'wanda',
            'aka':'aka',
            'zalunta':'zalinci',
            'kwayoyi':'kwaya',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
            '':'',
             
             





                
            
      # Add more words and their roots here
        }

        # Define lists of prefixes and suffixes
        self.prefixes = ["ma", "tsatt", "yan", "mai", "ba", "ta", "abin", "wuri-n"]
        self.suffixes = ["ai",'in','r', "ana","una", "ao", "ar", "awa", "aye", "cce", "che", "chi", "ci", "fa", "fen", "gu", "ilu", "ina", "ir", "ka", "ke", "ki", "ku", "mchi", "mci", "mtaka", "n", "nchi", "nci", "nda", "ni", " ake ","nka", "nku", "nna", "nni", "nnu", "nsa", "nsu", "nta", "ntka", "nu", "obi", "ochi", "odi", "ofi", "ogi", "oli", "ori", "oshi", "oti", "owa", "oyi", "rko", "ru", "sa", "shi", "suwa", "suwa"]

    def stem(self, input_text):
        # Remove punctuation and split into words
        import re
        words = re.findall(r'\b\w+\b', input_text.lower())

        # Create an empty list to store stemmed words
        stemmed_words = []

        # Define stemming rules
        for word in words:
            # Check if the word is a stopword
            if word in self.stopwords:
                continue  # Skip stopwords

            # Apply stemming rules
            if word in self.dictionary:
                # If the word is in the dictionary, return it as is
                stemmed_words.append(self.dictionary[word])
            else:
                # Apply complex rules for prefixes and suffixes
                for prefix in self.prefixes:
                    if word.startswith(prefix):
                        word = word[len(prefix):]
                        break  # Only remove one prefix
                
                for suffix in self.suffixes:
                    if word.endswith(suffix):
                        word = word[:-len(suffix)]
                        break  # Only remove one suffix

                
                # Add the stemmed word to the list
                stemmed_words.append(word)
                
                 # Filter out words with a length of 1 after stemming
                stemmed_words = [word for word in stemmed_words if len(word) > 1]


        return ' '.join(stemmed_words)

# Example usage
if __name__ == "__main__":
    stemmer = HausaStemmer()
    input_text = "Jiya da na je gida sai naga gidaje kusan dari uku akusa da gidajen saikin kano. Abin mamaki shine gidajensu Malam Sabitu ma ashe suna, kusa da gidan sarkin da aka gina gidanka dab da gidansa harda gidansu."
    stemmed_text = stemmer.stem(input_text)
    print("Input Text:\n", input_text, "\n")
    print("Stemmed Text:\n", stemmed_text)
    


# In[ ]:




